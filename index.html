<!DOCTYPE html>
<html lang="es-MX">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>SCORE STORE | Official Merchandise</title>
  <meta name="description" content="Merchandise Oficial SCORE International. Fabricado por √öNICO UNIFORMES." />

  <link rel="icon" href="/icons-score.svg" type="image/svg+xml" />
  <link rel="manifest" href="/site.webmanifest" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Teko:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/css/styles.css">
  <link rel="preload" href="/assets/hero.webp" as="image">
  
  <script src="https://js.stripe.com/v3" async></script>
</head>

<body>
  <div class="page-overlay"></div>

  <header class="topbar">
    <div class="container topbarInner">
      <a href="/" class="brand" aria-label="Inicio">
        <img src="/assets/logo-score.webp" alt="SCORE International" class="brandLogo">
      </a>
      
      <div class="nav">
        <div class="cartBtn" onclick="openDrawer()">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#111" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
          <span id="cartCount">0</span>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    
    <section class="hero" id="top">
      <div class="heroBg"></div>
      <div class="heroOverlay"></div>
      
      <img class="heroSeal" src="/assets/logo-world-desert.webp" alt="World Desert">

      <div class="heroContent">
        <div class="tag-line">
          <span class="tag-pill">OFICIAL</span> 2025 COLLECTION
        </div>
        
        <h1>SCORE<br><span>INTERNATIONAL</span></h1>
        
        <div class="marketing-copy">
          Viste la leyenda. Equipamiento oficial de alto rendimiento.<br>
          <strong>√öNICO UNIFORMES:</strong> Fabricante Autorizado.
        </div>

        <div class="ctaRow">
          <button class="btn primary" onclick="scrollToId('collections')">COMPRAR</button>
          <button class="btn secondary" onclick="openDrawer()">MI EQUIPO</button>
        </div>
      </div>
    </section>

    <section class="section" id="collections">
      <div class="sectionHead">
        <h2>COLECCIONES <span>DISPONIBLES</span></h2>
        <p>Selecciona tu carrera favorita.</p>
      </div>

      <div class="grid">
        <div class="champItem" onclick="openCatalog('BAJA_1000','BAJA 1000')">
          <div class="card-texture"></div> <span class="badge">TOP SELLER</span>
          <img src="/assets/logo-baja1000.webp" class="float-logo" alt="Baja 1000">
        </div>

        <div class="champItem" onclick="openCatalog('BAJA_500','BAJA 500')">
          <div class="card-texture"></div>
          <img src="/assets/logo-baja500.webp" class="float-logo" alt="Baja 500">
        </div>

        <div class="champItem" onclick="openCatalog('BAJA_400','BAJA 400')">
          <div class="card-texture"></div>
          <img src="/assets/logo-baja400.webp" class="float-logo" alt="Baja 400">
        </div>

        <div class="champItem" onclick="openCatalog('SF_250','SAN FELIPE 250')">
          <div class="card-texture"></div>
          <span class="badge" style="background:#333;">LAST CALL</span>
          <img src="/assets/logo-sf250.webp" class="float-logo" alt="San Felipe 250">
        </div>
      </div>
    </section>

    <section class="section shipping-section">
      <div class="container" style="text-align:center;">
        <div class="sectionHead" style="justify-content:center; border:none;">
          <h2 style="font-size:42px;">COTIZAR <span>ENV√çO</span></h2>
        </div>
        <p style="color:#aaa; margin-bottom:30px;">Calcula el costo real v√≠a Envia.com</p>
        
        <div class="shipBox">
          <div class="shipRow">
            <input class="inputField" id="zipQuote" inputmode="numeric" maxlength="5" placeholder="C√≥digo Postal (5 d√≠gitos)">
            <button class="btn primary" id="quoteBtn" style="border-radius:4px; font-size:16px; padding:12px 25px;">CALCULAR</button>
          </div>
          <div id="shipResult" class="shipResult"></div>
        </div>
      </div>
    </section>

    <section class="section partners">
      <div class="container">
        <div class="partnersGrid">
          <img src="/assets/logo-ford.webp" class="pLogo" alt="Ford">
          <img src="/assets/logo-rzr.webp" class="pLogo" alt="Polaris">
          <img src="/assets/logo-bfgodrich.webp" class="pLogo" alt="BFGoodrich">
          <img src="/assets/logo-unico.webp" class="pLogo" alt="Unico" style="opacity:1;">
        </div>
      </div>
    </section>

  </main>

  <footer class="footer">
    <div class="container footerInner">
      
      <div class="fCol">
        <img src="/assets/logo-unico.webp" alt="√önico" class="footerUnico">
        <p class="fText">
          Operador, Fabricante y Distribuidor Oficial de Merchandise SCORE International.
        </p>
      </div>

      <div class="fCol">
        <h4>SOPORTE</h4>
        <a href="#" onclick="openLegal('shipping');return false;" class="fLink">Rastreo de Env√≠os</a>
        <a href="#" onclick="openLegal('returns');return false;" class="fLink">Pol√≠tica de Devoluci√≥n</a>
        <a href="#" onclick="openLegal('billing');return false;" class="fLink">Facturaci√≥n 4.0</a>
      </div>

      <div class="fCol">
        <h4>LEGAL</h4>
        <a href="#" onclick="openLegal('terms');return false;" class="fLink">T√©rminos y Condiciones</a>
        <a href="#" onclick="openLegal('privacy');return false;" class="fLink">Aviso de Privacidad</a>
      </div>

      <div class="fCol">
        <h4>CONTACTO</h4>
        <div class="contactBox">
          <strong>√öNICO UNIFORMES</strong>
          <p style="color:#aaa; font-size:14px; margin-bottom:15px;">Palermo 6106 Interior JK,<br>Anexa Roma, 22614<br>Tijuana, B.C.</p>
          <a href="https://wa.me/526642368701" target="_blank" class="whatsapp-btn">
            üì± WhatsApp: 664 236 8701
          </a>
          <a href="mailto:ventas.unicotextil@gmail.com" class="fLink" style="margin-top:10px;">ventas.unicotextil@gmail.com</a>
        </div>
      </div>

    </div>
    <div class="copy">SCORE Store ¬© 2025 ¬∑ Powered by √önico Uniformes</div>
  </footer>

  <div class="overlay" id="overlay" onclick="closeAll()"></div>
  <div class="modal" id="modalCatalog">
    <div class="dHead">
      <h3 id="catTitle" class="dTitle">CAT√ÅLOGO</h3>
      <button class="closeBtn" onclick="closeAll()">‚úï</button>
    </div>
    <div id="catContent" class="dBody"></div>
  </div>

  <aside class="drawer" id="drawer">
    <div class="dHead">
      <h3 class="dTitle">TU EQUIPO</h3>
      <button class="closeBtn" onclick="closeAll()">‚úï</button>
    </div>
    <div class="dBody">
      <div id="cartItems"></div>
      <div id="cartEmpty" style="text-align:center; padding:40px; color:#666;">Tu carrito est√° vac√≠o.</div>
    </div>
    <div class="dFoot">
      <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <button onclick="emptyCart()" style="background:none; border:none; color:#E10600; font-size:12px; cursor:pointer; text-decoration:underline;">VACIAR CARRITO</button>
      </div>

      <div class="sumRow"><span>Subtotal</span><strong id="subTotal">$0</strong></div>
      <div class="sumRow"><span>Env√≠o</span><strong id="shipTotal">‚Äî</strong></div>
      <div class="sumRow total"><span>TOTAL</span><strong id="grandTotal">$0</strong></div>
      
      <button class="btn primary full" id="checkoutBtn" onclick="checkout()" style="width:100%; margin-top:15px; border-radius:8px;">PAGAR AHORA</button>
    </div>
  </aside>

  <aside class="drawer" id="legalModal" style="width:min(600px, 100vw);">
    <div class="dHead"><h3 class="dTitle">INFORMACI√ìN</h3><button class="closeBtn" onclick="closeAll()">‚úï</button></div>
    <div class="dBody" style="padding:40px; color:#333;">
       <div class="legalBlock" data-legal-block="shipping" style="display:none">
         <h4 style="color:var(--score-red);margin-bottom:10px;">Env√≠os</h4>
         <p>Env√≠os nacionales v√≠a FedEx/Estafeta (3-7 d√≠as). Pickup gratuito en nuestras oficinas de Tijuana.</p>
       </div>
       <div class="legalBlock" data-legal-block="returns" style="display:none">
         <h4 style="color:var(--score-red);margin-bottom:10px;">Garant√≠as</h4>
         <p>7 d√≠as por defectos de fabricaci√≥n.</p>
       </div>
       <div class="legalBlock" data-legal-block="billing" style="display:none">
         <h4 style="color:var(--score-red);margin-bottom:10px;">Facturaci√≥n</h4>
         <p>Env√≠a tu Constancia de Situaci√≥n Fiscal a ventas.unicotextil@gmail.com.</p>
       </div>
       <div class="legalBlock" data-legal-block="terms" style="display:none">
         <h4 style="color:var(--score-red);margin-bottom:10px;">T√©rminos</h4>
         <p>Precios en MXN incluyen IVA.</p>
       </div>
       <div class="legalBlock" data-legal-block="privacy" style="display:none">
         <h4 style="color:var(--score-red);margin-bottom:10px;">Privacidad</h4>
         <p>Tus datos son procesados de forma segura. No almacenamos informaci√≥n bancaria.</p>
       </div>
    </div>
  </aside>

  <div class="toast" id="toast">Mensaje</div>

  <script>
    const API_BASE = (location.hostname.includes('netlify')) ? '/.netlify/functions' : '/api';
    const CART_KEY = "score_cart_final_v5";
    
    let cart = [], catalog = [], shipQuote = null;
    const $ = (id) => document.getElementById(id);
    const money = (n) => new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(n||0);
    function scrollToId(id){ const el=$(id); if(el) el.scrollIntoView({behavior:"smooth",block:"start"}); }
    function toast(msg){ const t=$("toast"); t.innerText=msg; t.classList.add("show"); setTimeout(()=>t.classList.remove("show"),2500); }

    /* INIT */
    async function init(){
        loadCart(); updateTotals(); renderCart();
        try {
            const res = await fetch("/data/catalog.json");
            const data = await res.json();
            catalog = data.products || [];
        } catch(e){ console.error(e); }
    }

    /* OPEN MODAL CATALOG */
    window.openCatalog = (secId, title) => {
        $("modalCatalog").classList.add("active");
        $("overlay").classList.add("active");
        $("catTitle").innerText = title;
        $("catContent").innerHTML = "<div style='padding:40px; text-align:center; color:#555;'>Cargando inventario...</div>";

        const items = catalog.filter(p => p.sectionId === secId);
        if(!items.length) { $("catContent").innerHTML = "<div style='padding:40px; text-align:center; color:#999;'>Agotado.</div>"; return; }

        $("catContent").innerHTML = `<div class="catGrid">` + items.map(p => {
            const sizes = p.sizes || ["Unitalla"];
            const sizeBtns = sizes.map(s => `<div class="sizePill" onclick="selectSize(this,'${s}')">${s}</div>`).join("");
            
            return `
              <div class="prodCard" id="card_${p.id}">
                <div class="prodImg"><img src="${p.img}" loading="lazy" alt="${p.name}"></div>
                <div class="prodName">${p.name}</div>
                <div class="prodPrice">${money(p.baseMXN)}</div>
                <div class="sizeRow" id="sizes_${p.id}" data-selected="">${sizeBtns}</div>
                <button class="btn-add" onclick="add('${p.id}')">AGREGAR +</button>
              </div>
            `;
        }).join("") + `</div>`;
    };

    /* ACTIONS */
    window.selectSize = (el, s) => {
        const p = el.parentElement;
        p.setAttribute("data-selected", s);
        p.querySelectorAll(".sizePill").forEach(b => b.classList.remove("active"));
        el.classList.add("active");
    };

    window.add = (id) => {
        const sizeCont = document.getElementById(`sizes_${id}`);
        let s = sizeCont.getAttribute("data-selected");
        if(!s && sizeCont.children.length===1) s = sizeCont.children[0].innerText;
        if(!s) { toast("‚ö†Ô∏è Selecciona una talla"); return; }
        
        const p = catalog.find(x=>x.id===id);
        const key = `${id}_${s}`;
        const exist = cart.find(i=>i.key===key);
        if(exist) exist.qty++; else cart.push({key, id, name:p.name, variant:`Talla: ${s}`, price:p.baseMXN, qty:1, img:p.img});
        
        saveCart(); renderCart(); openDrawer(); toast("Agregado");
    };

    /* CART & CHECKOUT */
    function loadCart(){ try{cart=JSON.parse(localStorage.getItem(CART_KEY)||"[]")}catch{cart=[]} }
    function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
    function emptyCart(){ cart=[]; saveCart(); renderCart(); }

    function renderCart(){
        const wrap = $("cartItems");
        const count = cart.reduce((a,b)=>a+b.qty,0);
        $("cartCount").innerText = count;
        $("cartCount").style.display = count>0?"flex":"none";
        
        if(!cart.length){ wrap.innerHTML=""; $("cartEmpty").style.display="block"; updateTotals(); return; }
        $("cartEmpty").style.display="none";
        
        wrap.innerHTML = cart.map((i,x) => `
            <div class="cartItem">
                <img src="${i.img}" class="cartThumb">
                <div class="cInfo">
                    <div class="cName">${i.name}</div>
                    <div class="cMeta">${i.variant}</div>
                    <div class="cPrice">${money(i.price)}</div>
                </div>
                <button onclick="delCart(${x})" style="background:none;border:none;color:#aaa;font-size:18px;cursor:pointer;">&times;</button>
            </div>
        `).join("");
        updateTotals();
    }
    window.delCart = (x)=>{ cart.splice(x,1); saveCart(); renderCart(); };

    function updateTotals(){
        const sub = cart.reduce((a,b)=>a+(b.price*b.qty),0);
        $("subTotal").innerText = money(sub);
        const ship = shipQuote ? shipQuote.mxn : 0;
        $("shipTotal").innerText = shipQuote ? money(ship) : "Cotizar al pagar";
        $("grandTotal").innerText = money(sub + ship);
    }

    /* QUOTE & CHECKOUT */
    $("quoteBtn")?.addEventListener("click", async ()=>{
        const zip = $("zipQuote").value;
        if(zip.length!==5) { toast("CP Inv√°lido"); return; }
        $("shipResult").innerText = "Calculando...";
        try {
            const r = await fetch(`${API_BASE}/quote_shipping`, {method:"POST", body:JSON.stringify({postal_code:zip, items:1})});
            const d = await r.json();
            if(d.ok) { shipQuote=d; $("shipResult").innerHTML=`${d.label}: ${money(d.mxn)}`; updateTotals(); }
            else { $("shipResult").innerText="Est√°ndar: $250"; shipQuote={mxn:250}; updateTotals(); }
        } catch(e) { $("shipResult").innerText="Error conexi√≥n"; }
    });

    window.checkout = async () => {
        if(!cart.length) return;
        const btn = $("checkoutBtn"); btn.disabled=true; btn.innerText="PROCESANDO...";
        try {
            const r = await fetch(`${API_BASE}/create_checkout`, {method:"POST", body:JSON.stringify({items:cart, mode:"mx"})});
            const d = await r.json();
            if(d.url) location.href=d.url; else throw new Error();
        } catch(e) { toast("Error checkout"); btn.disabled=false; btn.innerText="PAGAR AHORA"; }
    };

    window.openDrawer=()=>{ $("drawer").classList.add("active"); $("overlay").classList.add("active"); document.body.classList.add("modalOpen"); };
    window.closeAll=()=>{ document.querySelectorAll(".active").forEach(e=>e.classList.remove("active")); document.body.classList.remove("modalOpen"); };
    window.openLegal=(t)=>{ $("legalModal").classList.add("active"); $("overlay").classList.add("active"); document.querySelectorAll(".legalBlock").forEach(b=>b.style.display=(b.dataset.legalBlock===t)?"block":"none"); };

    init();
    if("serviceWorker" in navigator) navigator.serviceWorker.register("/sw.js");
  </script>
</body>
</html>
